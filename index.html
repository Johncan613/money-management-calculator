<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precision Money Management Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c1a2d, #1a365d);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(15, 41, 107, 0.4);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(56, 139, 253, 0.2);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #60a5fa, #38bdf8);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a3bffa;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .account-control {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px auto;
            max-width: 600px;
            flex-wrap: wrap;
        }
        
        .account-box {
            background: rgba(30, 58, 138, 0.5);
            border-radius: 16px;
            padding: 20px;
            flex: 1;
            min-width: 250px;
            border: 1px solid rgba(56, 139, 253, 0.3);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        .account-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #93c5fd;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .account-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffffff;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 2px solid #3b82f6;
            background: rgba(15, 41, 107, 0.4);
            color: white;
            font-size: 1.1rem;
            margin-top: 8px;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        @media (max-width: 900px) {
            .calculator-container {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: rgba(15, 41, 107, 0.4);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(56, 139, 253, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3b82f6;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 22px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #a3bffa;
        }
        
        select, .price-input {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 2px solid #334155;
            background: rgba(15, 23, 42, 0.5);
            color: white;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        select:focus, .price-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(90deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        button:hover {
            background: linear-gradient(90deg, #2563eb, #1d4ed8);
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.3);
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .result-box {
            background: rgba(15, 41, 107, 0.5);
            border-radius: 14px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(56, 139, 253, 0.2);
        }
        
        .result-title {
            font-size: 1rem;
            margin-bottom: 8px;
            color: #93c5fd;
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .lot-size {
            color: #60a5fa;
        }
        
        .risk-amount {
            color: #f87171;
        }
        
        .reward-amount {
            color: #34d399;
        }
        
        .rr-container {
            margin: 35px 0;
        }
        
        .rr-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .risk-label {
            color: #f87171;
        }
        
        .reward-label {
            color: #34d399;
        }
        
        .rr-visual {
            display: flex;
            height: 40px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .risk-visual {
            background: linear-gradient(90deg, #ef4444, #f87171);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .reward-visual {
            background: linear-gradient(90deg, #10b981, #34d399);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .rr-ratio {
            text-align: center;
            font-size: 1.6rem;
            font-weight: bold;
            margin: 25px 0;
            padding: 15px;
            background: rgba(15, 41, 107, 0.5);
            border-radius: 14px;
            border: 1px solid rgba(56, 139, 253, 0.2);
        }
        
        .message {
            padding: 20px;
            border-radius: 14px;
            margin-top: 25px;
            font-weight: 500;
            display: none;
        }
        
        .success-message {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
        }
        
        .warning-message {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fde68a;
        }
        
        .danger-message {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fecaca;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #334155;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .note-box {
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .note-title {
            color: #fecaca;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .price-input-group {
            display: flex;
            gap: 15px;
        }
        
        .price-input-group .form-group {
            flex: 1;
        }
        
        .pip-value-table {
            width: 100%;
            margin-top: 25px;
            border-collapse: collapse;
            background: rgba(15, 41, 107, 0.4);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .pip-value-table th {
            background: rgba(30, 58, 138, 0.7);
            padding: 12px;
            text-align: left;
            color: #93c5fd;
        }
        
        .pip-value-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(56, 139, 253, 0.2);
        }
        
        .pip-value-table tr:last-child td {
            border-bottom: none;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            display: none;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(59, 130, 246, 0.3);
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 600px) {
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .price-input-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .rr-header {
                flex-direction: column;
                gap: 5px;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Precision Money Management Calculator</h1>
            <p class="subtitle">Calculate exact position sizing to strictly follow the 1% risk rule</p>
            
            <div class="account-control">
                <div class="account-box">
                    <div class="account-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="1" x2="12" y2="23"></line>
                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                        </svg>
                        Account Balance
                    </div>
                    <input type="number" id="balance" placeholder="Enter account balance" step="any" value="1000">
                </div>
                
                <div class="account-box">
                    <div class="account-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        Max Risk Per Trade
                    </div>
                    <div class="account-value" id="maxRisk">$10.00 (1%)</div>
                </div>
            </div>
        </header>
        
        <div class="calculator-container">
            <div class="card">
                <h2 class="section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                        <line x1="12" y1="22.08" x2="12" y2="12"></line>
                    </svg>
                    Trade Parameters
                </h2>
                
                <div class="form-group">
                    <label for="currency">Currency Pair</label>
                    <select id="currency">
                        <option value="EURUSD">EUR/USD</option>
                        <option value="GBPUSD" selected>GBP/USD</option>
                        <option value="USDJPY">USD/JPY</option>
                        <option value="AUDUSD">AUD/USD</option>
                        <option value="USDCAD">USD/CAD</option>
                        <option value="XAUUSD">Gold (XAU/USD)</option>
                    </select>
                </div>
                
                <div class="price-input-group">
                    <div class="form-group">
                        <label for="entry">Entry Price</label>
                        <input type="number" class="price-input" id="entry" placeholder="e.g. 1.23456" step="any" value="1.34456">
                    </div>
                    
                    <div class="form-group">
                        <label for="tradeType">Trade Type</label>
                        <select id="tradeType">
                            <option value="buy">Buy</option>
                            <option value="sell" selected>Sell</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="stopLoss">Stop-Loss Price</label>
                    <input type="number" class="price-input" id="stopLoss" placeholder="e.g. 1.23200" step="any" value="1.34522">
                </div>
                
                <div class="form-group">
                    <label for="takeProfit">Take-Profit Price</label>
                    <input type="number" class="price-input" id="takeProfit" placeholder="e.g. 1.24000" step="any" value="1.33932">
                </div>
                
                <button id="calculateBtn">
                    Calculate Position Sizing
                    <div class="loading-overlay" id="calculateLoading">
                        <div class="spinner"></div>
                    </div>
                </button>
                
                <div class="note-box">
                    <div class="note-title">Important Calculation Rules</div>
                    <p>1. 10 pips on 0.01 lot = $1.00 risk/reward</p>
                    <p>2. Strict 1% risk enforcement based on account balance</p>
                    <p>3. No lot size shown if trade violates 1% rule</p>
                </div>
            </div>
            
            <div class="card">
                <h2 class="section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                    Trade Analysis
                </h2>
                
                <div class="result-grid">
                    <div class="result-box">
                        <div class="result-title">Lot Size</div>
                        <div class="result-value lot-size" id="lotSize">0.15000</div>
                    </div>
                    
                    <div class="result-box">
                        <div class="result-title">Risk Amount</div>
                        <div class="result-value risk-amount" id="riskAmount">$9.90</div>
                    </div>
                    
                    <div class="result-box">
                        <div class="result-title">Potential Reward</div>
                        <div class="result-value reward-amount" id="rewardAmount">$78.60</div>
                    </div>
                    
                    <div class="result-box">
                        <div class="result-title">Pip Distance (SL/TP)</div>
                        <div class="result-value" id="pipDistance">6.6 / 52.4</div>
                    </div>
                </div>
                
                <div class="rr-ratio">
                    Risk-to-Reward Ratio: <span id="rrRatio">1:7.94</span>
                </div>
                
                <div class="rr-container">
                    <div class="rr-header">
                        <span class="risk-label">Risk: $9.90</span>
                        <span class="reward-label">Reward: $78.60</span>
                    </div>
                    <div class="rr-visual">
                        <div class="risk-visual" id="riskVisual" style="width: 12%;">$9.90</div>
                        <div class="reward-visual" id="rewardVisual" style="width: 88%;">$78.60</div>
                    </div>
                </div>
                
                <div class="message success-message" id="successMessage">
                    ✅ This trade complies with the 1% risk rule! You can safely enter this position.
                </div>
                
                <div class="message warning-message" id="warningMessage">
                    ⚠️ Warning: This trade violates the 1% risk rule! Do not enter this trade.
                </div>
                
                <div class="message danger-message" id="dangerMessage">
                    ❌ Error: Unable to calculate position sizing. Please check your inputs.
                </div>
                
                <table class="pip-value-table">
                    <tr>
                        <th>Lot Size</th>
                        <th>Value per 10 pips</th>
                    </tr>
                    <tr>
                        <td>0.01 (Micro)</td>
                        <td>$1.00</td>
                    </tr>
                    <tr>
                        <td>0.10 (Mini)</td>
                        <td>$10.00</td>
                    </tr>
                    <tr>
                        <td>1.00 (Standard)</td>
                        <td>$100.00</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <footer>
            <p>Precision Money Management Calculator for Serious Traders | Always risk no more than 1% of your account per trade</p>
            <p>Note: Calculations are based on standard pip values. For JPY pairs, 1 pip = 0.01. For others, 1 pip = 0.0001.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculateBtn');
            const balanceInput = document.getElementById('balance');
            const maxRiskDisplay = document.getElementById('maxRisk');
            const loadingOverlay = document.getElementById('calculateLoading');
            
            // Update max risk when balance changes
            balanceInput.addEventListener('input', updateMaxRisk);
            
            // Calculate on button click
            calculateBtn.addEventListener('click', calculatePosition);
            
            // Add input listeners for auto-calculation
            document.querySelectorAll('#currency, #tradeType, #entry, #stopLoss, #takeProfit').forEach(input => {
                input.addEventListener('change', calculatePosition);
            });
            
            // Initialize
            updateMaxRisk();
            calculatePosition();
            
            function updateMaxRisk() {
                const balance = parseFloat(balanceInput.value) || 1000;
                const maxRiskAmount = (balance * 0.01).toFixed(2);
                maxRiskDisplay.textContent = `$${maxRiskAmount} (1%)`;
            }
            
            function showLoading() {
                loadingOverlay.style.display = 'flex';
                calculateBtn.disabled = true;
            }
            
            function hideLoading() {
                loadingOverlay.style.display = 'none';
                calculateBtn.disabled = false;
            }
            
            function calculatePosition() {
                showLoading();
                
                // Use timeout to allow UI to update
                setTimeout(() => {
                    try {
                        // Hide all messages
                        document.getElementById('successMessage').style.display = 'none';
                        document.getElementById('warningMessage').style.display = 'none';
                        document.getElementById('dangerMessage').style.display = 'none';
                        
                        // Get input values
                        const balance = parseFloat(balanceInput.value) || 1000;
                        const currencyPair = document.getElementById('currency').value;
                        const tradeType = document.getElementById('tradeType').value;
                        const entryPrice = parseFloat(document.getElementById('entry').value);
                        const stopLoss = parseFloat(document.getElementById('stopLoss').value);
                        const takeProfit = parseFloat(document.getElementById('takeProfit').value);
                        
                        // Validate inputs
                        if (isNaN(entryPrice) || isNaN(stopLoss) || isNaN(takeProfit) || 
                            entryPrice <= 0 || stopLoss <= 0 || takeProfit <= 0) {
                            document.getElementById('dangerMessage').style.display = 'block';
                            hideLoading();
                            return;
                        }
                        
                        // Account parameters
                        const maxRiskPercent = 0.01; // 1% risk
                        const maxRiskAmount = balance * maxRiskPercent;
                        
                        // Determine pip size based on currency pair
                        const pipSize = currencyPair === 'XAUUSD' ? 0.01 : 
                                       currencyPair.includes('JPY') ? 0.01 : 0.0001;
                        
                        // Fixed value for all: 10 pips on 0.01 lot = $1.00 -> so per pip per lot = $10
                        const riskPerPipPerLot = 10;
                        
                        // Calculate pip distances - direction depends on trade type
                        let slDistancePips, tpDistancePips;
                        
                        if (tradeType === 'buy') {
                            slDistancePips = Math.abs(entryPrice - stopLoss) / pipSize;
                            tpDistancePips = Math.abs(takeProfit - entryPrice) / pipSize;
                        } else { // sell
                            slDistancePips = Math.abs(stopLoss - entryPrice) / pipSize;
                            tpDistancePips = Math.abs(entryPrice - takeProfit) / pipSize;
                        }
                        
                        // Calculate the maximum lot size that doesn't exceed 1% risk
                        const maxLotSize = maxRiskAmount / (slDistancePips * riskPerPipPerLot);
                        
                        // Round to nearest 0.01 lot (minimum tradable size)
                        let lotSize = Math.floor(maxLotSize * 100) / 100;
                        
                        // Calculate actual risk and reward
                        let riskAmount = 0, rewardAmount = 0;
                        let validTrade = false;
                        
                        if (lotSize >= 0.01) {
                            riskAmount = lotSize * slDistancePips * riskPerPipPerLot;
                            rewardAmount = lotSize * tpDistancePips * riskPerPipPerLot;
                            
                            // Round to cents to avoid floating point issues
                            riskAmount = Math.round(riskAmount * 100) / 100;
                            rewardAmount = Math.round(rewardAmount * 100) / 100;
                            
                            // Ensure we don't exceed max risk
                            if (riskAmount <= maxRiskAmount * 1.01) { // Allow 1% tolerance
                                validTrade = true;
                            } else {
                                lotSize = 0;
                            }
                        } else {
                            lotSize = 0;
                        }
                        
                        // If lot size is 0, calculate risk for minimum lot size for warning
                        let minLotRisk = 0;
                        if (lotSize === 0 && slDistancePips > 0) {
                            minLotRisk = 0.01 * slDistancePips * riskPerPipPerLot;
                            minLotRisk = Math.round(minLotRisk * 100) / 100;
                        }
                        
                        // Calculate risk-to-reward ratio
                        let rrRatio = 0;
                        if (riskAmount > 0) {
                            rrRatio = (rewardAmount / riskAmount).toFixed(2);
                        }
                        
                        // Calculate visual risk/reward percentages
                        let riskPercent = 0, rewardPercent = 0;
                        if (riskAmount > 0 || rewardAmount > 0) {
                            const total = riskAmount + rewardAmount;
                            riskPercent = Math.round((riskAmount / total) * 100);
                            rewardPercent = 100 - riskPercent;
                        }
                        
                        // Update UI
                        if (validTrade) {
                            document.getElementById('lotSize').textContent = lotSize.toFixed(5);
                            document.getElementById('riskAmount').textContent = '$' + riskAmount.toFixed(2);
                            document.getElementById('rewardAmount').textContent = '$' + rewardAmount.toFixed(2);
                            document.getElementById('pipDistance').textContent = `${slDistancePips.toFixed(1)} / ${tpDistancePips.toFixed(1)}`;
                            document.getElementById('rrRatio').textContent = '1:' + rrRatio;
                            
                            // Update risk/reward visual
                            document.getElementById('riskVisual').style.width = riskPercent + '%';
                            document.getElementById('riskVisual').textContent = '$' + riskAmount.toFixed(2);
                            document.getElementById('rewardVisual').style.width = rewardPercent + '%';
                            document.getElementById('rewardVisual').textContent = '$' + rewardAmount.toFixed(2);
                            
                            document.getElementById('successMessage').style.display = 'block';
                        } else {
                            document.getElementById('lotSize').textContent = 'N/A';
                            document.getElementById('riskAmount').textContent = 'N/A';
                            document.getElementById('rewardAmount').textContent = 'N/A';
                            document.getElementById('pipDistance').textContent = `${slDistancePips.toFixed(1)} / ${tpDistancePips.toFixed(1)}`;
                            document.getElementById('rrRatio').textContent = 'N/A';
                            
                            document.getElementById('riskVisual').style.width = '0%';
                            document.getElementById('riskVisual').textContent = '';
                            document.getElementById('rewardVisual').style.width = '0%';
                            document.getElementById('rewardVisual').textContent = '';
                            
                            if (minLotRisk > 0) {
                                const riskPercent = ((minLotRisk / balance) * 100).toFixed(2);
                                document.getElementById('warningMessage').innerHTML = 
                                    `⚠️ Warning: This trade violates the 1% risk rule!<br>
                                     Even the minimum lot size (0.01) would risk $${minLotRisk.toFixed(2)} (${riskPercent}% of your account).`;
                                document.getElementById('warningMessage').style.display = 'block';
                            } else {
                                document.getElementById('warningMessage').style.display = 'block';
                            }
                        }
                    } catch (error) {
                        console.error('Calculation error:', error);
                        document.getElementById('dangerMessage').style.display = 'block';
                    } finally {
                        hideLoading();
                    }
                }, 100);
            }
        });
    </script>
</body>
</html>
